(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6f67d100"],{"0bbc":function(e,t,a){e.exports=a.p+"img/notify.0c871ea0.jpg"},"167b3":function(e,t,a){"use strict";var n=a("52c3"),i=a.n(n);i.a},"1fc13":function(e,t,a){},"3b4e":function(e,t,a){"use strict";var n=a("5c7c"),i=a.n(n);i.a},"4b42":function(e,t,a){"use strict";var n=a("9f89"),i=a.n(n);i.a},"5115f":function(e,t,a){},"52c3":function(e,t,a){},"54a5":function(e,t,a){"use strict";var n=a("f23a"),i=a.n(n);i.a},"5c7c":function(e,t,a){},"5ca5":function(e,t,a){},"5f2c":function(e,t,a){},"6c9e":function(e,t,a){},"736a":function(e,t,a){"use strict";var n=a("1fc13"),i=a.n(n);i.a},"74c7":function(e,t,a){"use strict";var n=a("daab"),i=a.n(n);i.a},"88cb":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.$route.query.sideTab?a("ScrollBar",{staticStyle:{height:"100%"}},[a(e.$route.query.sideTab,{tag:"components"})],1):a("div",{attrs:{id:"indexLayout"}},[e.notIframe?a("div",{staticClass:"sideWrapper",class:{sideShow:e.isMobile&&e.isSideBarCollapse},on:{click:function(t){return t.target!==t.currentTarget?null:e.toggleSideBar(t)}}},[a("SideBar")],1):e._e(),a("ScrollBar",{staticClass:"main"},[a("div",{staticClass:"mainViewFix",class:{iframe:!e.notIframe}},[e.notIframe?a("Header"):e._e(),a("div",{staticClass:"mainContent"},[a("ScrollBar",{staticClass:"defaultMain"},[a("div",{staticClass:"mainScroll",class:"fontSize-"+e.fontSize+"p"},[a("transition",{attrs:{duration:300,name:"fade",mode:"out-in","enter-active-class":"animate__animated animate__fadeIn","leave-active-class":"animate__animated animate__fadeOut"}},[a("keep-alive",{attrs:{include:e.getActiveTab}},[a("router-view",{key:e.$route.path})],1)],1)],1)]),!e.isMobile&&e.notIframe&&e.useSideTabs?a("div",{staticClass:"sideWrapper"},[a("SideTab")],1):e._e()],1)],1)]),e.isMobile&&e.notIframe&&e.useSideTabs?a("div",{staticClass:"sideWrapper",class:{sideShow:e.isMobile&&e.isSideTabCollapse},on:{click:function(t){return t.target!==t.currentTarget?null:e.toggleSideTab(t)}}},[a("SideTab")],1):e._e(),a("JsPanels")],1)},i=[],s=(a("4160"),a("9911"),a("159b"),a("5530")),r=a("6cdb"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",e._l(e.panels,(function(t){return a("JsPanel",{key:t.component+"-"+t.id,attrs:{visible:t.show,options:t.options},on:{close:function(a){return e.closePanel(t.component,t.id)}}},[a(t.component,e._g(e._b({tag:"component",staticClass:"panel",class:"fontSize-"+e.fontSize+"p"},"component",t.props,!1,!0),t.events))],1)})),1)},c=[],l=a("2ef0"),u=a("2f62"),d={name:"JsPanels",computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(u["b"])("app",{fontSize:function(e){return e.fontSize}})),Object(u["b"])("JsPanels",{JsPanels:function(e){return e.panels}})),{},{panels:function(){return Object(l["cloneDeep"])(this.JsPanels)}}),methods:{closePanel:function(e,t){this.$store.dispatch("JsPanels/closePanel",{component:e,id:t})}}},p=d,f=a("2877"),h=Object(f["a"])(p,o,c,!1,null,null,null),m=h.exports,b=m,v=a("b047"),g=a.n(v),C=(a("1b62"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"header"}},[a("div",{staticClass:"headAside"},[a("TabNav")],1),a("div",{staticClass:"headAside userHead"},[a("el-button",{directives:[{name:"popover",rawName:"v-popover:popoverUserset",arg:"popoverUserset"}]},[e._v(e._s(e.userData.nickName+" 【"+e.userData.account+"】"))]),a("el-badge",{directives:[{name:"popover",rawName:"v-popover:popoverNotify",arg:"popoverNotify"}],attrs:{id:"notice"}},[a("el-button",{attrs:{icon:"el-icon-message-solid"}})],1),a("el-tooltip",{attrs:{effect:"dark",content:"登出",placement:"bottom"}},[a("el-button",{attrs:{icon:"el-icon-switch-button"},on:{click:e.logout}})],1),e.useSideTabs?a("el-button",{attrs:{collapse:e.isSideTabCollapse,icon:"el-icon-s-unfold"},on:{click:e.toggleSideTab}}):e._e()],1),a("el-popover",{ref:"popoverNotify",attrs:{placement:"bottom",trigger:"click","popper-class":"notifications"},model:{value:e.showNotify,callback:function(t){e.showNotify=t},expression:"showNotify"}},[a("Notify",{directives:[{name:"show",rawName:"v-show",value:e.showNotify,expression:"showNotify"}]})],1),a("el-popover",{ref:"popoverUserset",attrs:{placement:"bottom",trigger:"click","popper-class":"userset"},model:{value:e.showUserset,callback:function(t){e.showUserset=t},expression:"showUserset"}},[e.showUserset?a("Userset"):e._e()],1)],1)}),w=[],S=(a("96cf"),a("1da1")),k=a("2934"),_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"userset"}},[a("h6",[e._v("使用者偏好設定")]),a("el-form",[a("el-form-item",{attrs:{label:e.$t("userPreference.toggleMenuList")}},[a("el-switch",{staticClass:"switch-group",attrs:{value:e.isSideBarCollapse},on:{change:e.sideBarCollapse}})],1),e.useSideTabs?a("el-form-item",{attrs:{label:e.$t("userPreference.toggleTagList")}},[a("el-switch",{staticClass:"switch-group",attrs:{value:e.isSideTabCollapse},on:{change:e.sideTabCollapse}})],1):e._e(),a("el-form-item",{attrs:{label:e.$t("userPreference.recordTabs")}},[a("el-switch",{staticClass:"switch-group",attrs:{value:e.isRecordTabs},on:{change:e.recordtabs}})],1),a("el-form-item",{staticClass:"fontSize",attrs:{label:e.$t("userPreference.fontSize")}},[a("el-select",{attrs:{value:e.fontSize},on:{change:e.changeFontSize}},e._l(e.fontSizes,(function(e){return a("el-option",{key:e,attrs:{value:e,label:e+"%"}})})),1)],1)],1)],1)},y=[],x={name:"Userset",data:function(){return{fontSizes:["100","110","125"],useSideTabs:!0}},computed:Object(s["a"])(Object(s["a"])({},Object(u["b"])("app",{fontSize:function(e){return e.fontSize},lang:function(e){return e.lang},langMap:function(e){return e.langMap},isSideBarCollapse:function(e){return e.isSideBarCollapse},isSideTabCollapse:function(e){return e.isSideTabCollapse}})),Object(u["b"])("tabs",{isRecordTabs:function(e){return e.isRecordTabs}})),methods:{sideBarCollapse:function(){this.$store.dispatch("app/setSideBarCollapse"),this.$store.dispatch("updateUserPreferences")},sideTabCollapse:function(){this.$store.dispatch("app/setSideTabCollapse"),this.$store.dispatch("updateUserPreferences")},changeFontSize:function(e){this.$store.dispatch("app/setFontSize",e),this.$store.dispatch("updateUserPreferences")},recordtabs:function(){this.$store.dispatch("tabs/setRecordtabs"),this.$store.dispatch("updateUserPreferences")},changeLang:function(e){this.$i18n.locale=e,this.$store.dispatch("app/setLang",e)}}},T=x,$=(a("bb53"),Object(f["a"])(T,_,y,!1,null,null,null)),O=$.exports,N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"tabNav"}},[e.needArrow?a("div",{staticClass:"arrow arrowPre",on:{click:function(t){return e.slideTabs("pre")}}},[a("i",{staticClass:"el-icon-arrow-left"})]):e._e(),a("div",{ref:"outter",staticClass:"tabs"},[a("ul",{ref:"tabs",style:{transform:"translateX("+e.ulmoves+"px)"}},[a("li",{class:{tabActive:e.checkUrlPath({link:"index"})},on:{click:function(t){return e.switchRoute({link:"index"})}}},[a("p",[e._v("首頁")])]),e._l(e.tabs,(function(t,n){return a("li",{key:t.id,staticClass:"drag-handler",class:{tabActive:e.checkUrlPath(t)},on:{mousedown:function(a){return e.handleMouseMiddleClick(a,t)},click:function(a){return a.preventDefault(),e.switchRoute(t)}}},[a("p",[e._v(e._s(t.title))]),a("i",{staticClass:"el-icon-close",on:{click:function(a){return a.stopPropagation(),e.closeTab(t)}}})])}))],2)]),e.needArrow?a("div",{staticClass:"arrow arrowNext",on:{click:function(t){return e.slideTabs("next")}}},[a("i",{staticClass:"el-icon-arrow-right"})]):e._e()])},M=[],j=(a("c740"),a("aa47")),B=a("ed08"),P={name:"TabNav",data:function(){return{sortable:null}},computed:Object(s["a"])(Object(s["a"])({},Object(u["b"])("tabs",{tabs:function(e){return e.tabs},steps:function(e){return e.steps},gap:function(e){return e.gap}})),{},{ulmoves:function(){return 150*-this.steps},needArrow:function(){return 0!==this.gap&&this.gap<=this.tabs.length}}),watch:{needArrow:{handler:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$nextTick();case 2:e.setSortable();case 3:case"end":return t.stop()}}),t)})))()}}},mounted:function(){this.initAction(),this.$bus.$on("check-tab-nav-width",this.checkWidth)},beforeDestroy:function(){this.$bus.$off("check-tab-nav-width")},methods:{initAction:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(B["d"])(0);case 2:e.checkWidth(),e.setSortable();case 4:case"end":return t.stop()}}),t)})))()},setSortable:function(){var e=this,t=this.$refs.tabs;this.sortable=j["a"].create(t,{ghostClass:"sortable-ghost",handle:".drag-handler",onEnd:function(t){var a=t.oldIndex,n=t.newIndex,i={oldIndex:a-1,newIndex:n-1};e.$store.dispatch("tabs/sortTabs",i),e.$store.dispatch("updateUserPreferences")}})},checkWidth:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var a,n,i,s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(B["d"])(0);case 2:a=e.$refs.outter.offsetWidth,n=Math.floor(a/150),i=0,e.needArrow&&(s=e.tabs.findIndex((function(t){return"/".concat(t.link)===e.$route.path})),i=-1===s||s<n-1?0:s+2-n),r={steps:i,gap:n},e.$store.dispatch("tabs/setTabStatus",r),e.$store.dispatch("updateUserPreferences");case 9:case"end":return t.stop()}}),t)})))()},checkUrlPath:function(e){var t=e.link,a=e.menuCode,n=e.viewType,i=void 0===n?null:n,s="/".concat(t);return i&&(s="/".concat(a)),this.$route.path===s},slideTabs:function(e){var t=this.steps;"pre"===e&&this.steps>0&&t--,"next"===e&&this.steps<=this.tabs.length-this.gap&&t++;var a={steps:t,gap:this.gap};this.$store.dispatch("tabs/setTabStatus",a),this.$store.dispatch("updateUserPreferences")},closeTab:function(e){var t=this.tabs,a=t.findIndex((function(t){return t.menuCode===e.menuCode})),n=this.$route.path==="/".concat(t[a].link)||this.$route.path==="/".concat(t[a].menuCode);if(n){var i="/index";if(a){var s=t[a-1],r=s.viewType,o=void 0===r?null:r,c=s.menuCode,l=s.link;i="/".concat(o?c:l)}this.$router.push({path:i})}this.checkWidth(),this.$store.dispatch("tabs/closeTab",e),this.$store.dispatch("updateUserPreferences")},switchRoute:function(e){var t=e.link,a=e.menuCode,n=e.viewType,i=void 0===n?null:n,s="/".concat(t);i&&(s="/".concat(a)),this.$route.path!==s&&this.$router.push({path:s})},handleMouseMiddleClick:function(e,t){1===e.button&&this.closeTab(t)}}},E=P,I=(a("3b4e"),Object(f["a"])(E,N,M,!1,null,"61ac8230",null)),R=I.exports,D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"notifications"}},[e._m(0),a("ScrollBar",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"content"},[a("el-collapse",{model:{value:e.activePanels,callback:function(t){e.activePanels=t},expression:"activePanels"}},[e.unReadList.length>0?a("el-collapse-item",{attrs:{title:"未讀取("+e.unReadList.length+")",name:"notRead"}},e._l(e.unReadList,(function(t){return a("div",{key:t.fromEmployeeId,staticClass:"context"},[a("div",{staticClass:"context-left"},[a("i",{class:e.contextIconName(t.type)})]),a("div",{staticClass:"context-right"},[a("div",{staticClass:"frame"},[a("div",{staticClass:"title"},[e._v(e._s(""+t.fromEmployeeId+t.title))]),a("div",{staticClass:"subject"},[e._v(e._s(t.message))])]),a("div",{staticClass:"time"},[e._v(e._s(e.changeFormat(t.createdOn)))])])])})),0):e._e(),e.isReadList.length>0?a("el-collapse-item",{attrs:{title:"已讀取",name:"hasRead"}},e._l(e.isReadList,(function(t,n){return a("div",{key:t.fromEmployeeId,staticClass:"context"},[a("div",{staticClass:"context-left"},[a("i",{class:e.contextIconName(t.type)})]),a("div",{staticClass:"context-right"},[a("div",{staticClass:"frame"},[a("div",{staticClass:"title"},[e._v(e._s(""+t.fromEmployeeId+t.title))]),a("div",{staticClass:"subject"},[e._v(e._s(t.message))])]),a("div",{staticClass:"time"},[e._v(e._s(e.changeFormat(t.createdOn)))])])])})),0):e._e()],1)],1),a("div",{staticClass:"fixed-footer"},[a("DesktopNotifySwitch")],1)],1)},U=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"header"},[a("p",[e._v("通知")])])}],z=a("c1df"),A=a.n(z),L=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"notify-switch"},[e._v("桌面通知"),n("el-switch",{staticClass:"switch",on:{change:e.toggleNotificationPermissions},model:{value:e.isDesktopNotifyEnabled,callback:function(t){e.isDesktopNotifyEnabled=t},expression:"isDesktopNotifyEnabled"}}),n("el-dialog",{staticClass:"dialog",attrs:{title:"您的桌面通知功能已被禁用",visible:e.isModalShow,width:"30%","show-close":!1,center:"","modal-append-to-body":!1},on:{"update:visible":function(t){e.isModalShow=t}}},[n("section",[n("p",[e._v("若需重新啟用此功能，請將下圖標記「"),n("span",{staticClass:"forbidden"},[e._v("封鎖")]),e._v("」項目改為「"),n("span",{staticClass:"primary"},[e._v("允許")]),e._v("」，並重新整理網頁")]),n("br"),n("img",{attrs:{src:a("0bbc"),width:"100%"}})])])],1)},W=[],q={data:function(){return{isModalShow:!1,isDesktopNotifyEnabled:!1,isForbidden:!1}},created:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$nextTick();case 2:if(a=Notification.permission,"granted"===a||"denied"===a){t.next=14;break}return t.prev=4,t.next=7,Notification.requestPermission();case 7:n=t.sent,"granted"===n||"denied"===n?localStorage.setItem("notification-permissions","granted"):e.requestPermission(),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),e.isDesktopNotifyEnabled=!1;case 14:e.checkDesktopNotificationStatus();case 15:case"end":return t.stop()}}),t,null,[[4,11]])})))()},methods:{checkDesktopNotificationStatus:function(){if(!window.Notification)return this.$notify({title:"系統提示",message:"您的瀏覽器未支援「桌面通知」功能",type:"warning"}),void(this.isDesktopNotifyEnabled=!1);var e=localStorage.getItem("notification-permissions");switch(Notification.permission){case"granted":"denied(by user)"!==e&&localStorage.setItem("notification-permissions","granted");break;case"denied":localStorage.setItem("notification-permissions","denied"),this.isForbidden=!0;break;default:break}e=localStorage.getItem("notification-permissions"),e?this.isDesktopNotifyEnabled="granted"===e:this.requestPermission()},requestPermission:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Notification.requestPermission();case 3:a=t.sent,"granted"===a?localStorage.setItem("notification-permissions","granted"):localStorage.setItem("notification-permissions","denied"),e.checkDesktopNotificationStatus(),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.isDesktopNotifyEnabled=!1;case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},toggleNotificationPermissions:function(e){var t=this;return Object(S["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:a.t0=Notification.permission,a.next="granted"===a.t0?3:"denied"===a.t0?6:"default"===a.t0?9:20;break;case 3:return localStorage.setItem("notification-permissions",e?"granted":"denied(by user)"),t.$notify({title:"系統提示",message:"「桌面通知」功能已".concat(e?"開啟":"關閉"),type:"success"}),a.abrupt("break",21);case 6:return localStorage.setItem("notification-permissions","denied"),t.isModalShow=!0,a.abrupt("break",21);case 9:return a.prev=9,a.next=12,Notification.requestPermission();case 12:n=a.sent,"granted"===n||"denied"===n?localStorage.setItem("notification-permissions",e?"granted":"denied"):t.requestPermission(),a.next=19;break;case 16:a.prev=16,a.t1=a["catch"](9),t.isDesktopNotifyEnabled=!1;case 19:return a.abrupt("break",21);case 20:return a.abrupt("break",21);case 21:t.checkDesktopNotificationStatus();case 22:case"end":return a.stop()}}),a,null,[[9,16]])})))()}}},J=q,H=(a("96c4"),Object(f["a"])(J,L,W,!1,null,null,null)),F=H.exports,V={name:"Notify",components:{ScrollBar:r["a"],DesktopNotifySwitch:F},data:function(){return{loading:!1,activePanels:["notRead"],unReadList:[{createdOn:"2020-03-23 10:55:29",fromEmployeeId:"上仁",message:"test",title:"取消行程",type:3}],isReadList:[{createdOn:"2020-03-23 10:55:29",fromEmployeeId:"上仁",message:"test",title:"取消行程",type:3}]}},computed:{changeFormat:function(){return function(e){return A()(e).locale("zh-cn").calendar(null,{sameDay:"[今天] kk:mm",nextDay:"[明天] kk:mm",nextWeek:"[下]dddd kk:mm",lastDay:"[昨天] kk:mm",lastWeek:"[上]dddd kk:mm",sameElse:"YYYY-MM-DD kk:mm"})}}},methods:{contextIconName:function(e){switch(e){case 1:return"el-icon-circle-plus-outline";case 2:return"el-icon-edit-outline";case 3:return"el-icon-circle-close";case 4:return"el-icon-remove-outline";case 5:return"el-icon-warning";default:return"el-icon-right"}}}},G=V,Y=(a("167b3"),Object(f["a"])(G,D,U,!1,null,null,null)),K=Y.exports,X={name:"Header",components:{TabNav:R,Notify:K,Userset:O},data:function(){return{showNotify:!1,showUserset:!1,userData:{account:123456,nickName:"Austin"},useSideTabs:!0}},computed:Object(s["a"])({},Object(u["b"])("app",{isSideTabCollapse:function(e){return e.isSideTabCollapse}})),methods:{toggleSideTab:function(){this.$store.dispatch("app/setSideTabCollapse"),this.$store.dispatch("updateUserPreferences")},logout:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("updateUserPreferencesDirectly");case 3:return t.next=5,e.$confirm("確認登出系統？","提醒",{confirmButtonText:"確認",cancelButtonText:"取消",closeOnClickModal:!1,cancelButtonClass:"cancelButton",confirmButtonClass:"confirmButton",type:"warning"});case 5:return t.next=7,k["a"].logout();case 7:e.$message({message:"已登出成功",type:"success"}),localStorage.clear(),e.$router.push({path:"true"===Object({NODE_ENV:"production",VUE_APP_APIPATH:"https://pub-site-info.bckplat.info/api",VUE_APP_PROJECT_NAME:"Vue_Core_System",VUE_APP_SOCKET_URL:"wss://api-socket.wpc6666.com",VUE_APP_USESIDETABS:"true",BASE_URL:"/vue-core/"}).VUE_APP_LOGIN_PAGE?"/login":"/401"}),t.next=14;break;case 12:t.prev=12,t.t0=t["catch"](0);case 14:case"end":return t.stop()}}),t,null,[[0,12]])})))()}}},Q=X,Z=(a("f6b9"),Object(f["a"])(Q,C,w,!1,null,"042ffff5",null)),ee=Z.exports,te=ee,ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-aside",{style:{width:!e.isMobile&&e.isSideBarCollapse?"64px":"auto"},attrs:{id:"sideBar",collapse:!e.isMobile&&e.isSideBarCollapse}},[a("div",{staticClass:"sideBarLogo"},[a("div",{staticClass:"systemName"},[e._v(e._s(e.getProjectName))]),e.isMobile?e._e():a("i",{staticClass:"el-icon-s-fold",attrs:{collapse:e.isSideBarCollapse},on:{click:e.toggleSideBar}})]),e.isMobile?a("i",{staticClass:"toggle el-icon-arrow-right",attrs:{collapse:e.isSideBarCollapse},on:{click:e.toggleSideBar}}):e._e(),a("ScrollBar",{staticClass:"menuList"},[a("el-menu",{staticClass:"el-menu",attrs:{"default-active":e.activeIndex,collapse:!e.isMobile&&e.isSideBarCollapse,router:!1,"collapse-transition":!1},nativeOn:{transitionend:function(t){return e.emitCheckTabNav(t)}}},[a("el-menu-item-group",{staticClass:"menuGroup"},[a("el-menu-item",{attrs:{index:"1"},on:{click:function(t){return e.switchRoute("/index")}}},[a("i",{staticClass:"el-icon-s-home"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("首頁")])])],1),e._l(e.menuList,(function(t){return a("el-menu-item-group",{key:t.id,staticClass:"menuGroup"},[a("template",{slot:"title"},[e.isMobile||!e.isSideBarCollapse?a("span",[e._v(e._s(e.getMenuTitle(t.i18n,t.title)))]):a("span",[e._v(e._s(e.getMenuTitle(t.i18n,t.title).slice(0,2)))])]),e._l(t.children,(function(e){return[a("MenuNode",{key:e.id,attrs:{nodeData:e}})]}))],2)}))],2)],1)],1)},ne=[],ie=(a("7db0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.nodeData.children.length?a("el-submenu",{attrs:{index:String(e.nodeData.id)}},[a("template",{slot:"title"},[a("i",{class:"fa fa-"+e.nodeData.iconName}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.getMenuTitle))])]),e._l(e.nodeData.children,(function(e){return[a("MenuNode",{key:e.id,attrs:{nodeData:e}})]}))],2):a("el-menu-item",{attrs:{index:String(e.nodeData.id)},on:{click:e.handleNavClick}},[a("i",{class:"fa fa-"+e.nodeData.iconName}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.getMenuTitle))])])}),se=[],re=(a("99af"),{name:"MenuNode",props:{nodeData:{type:Object,default:null}},computed:Object(s["a"])(Object(s["a"])({},Object(u["b"])("app",{isMobile:function(e){return e.isMobile}})),{},{getMenuTitle:function(){var e=this.$i18n.locale;return this.nodeData.i18n&&this.nodeData.i18n[e]?this.nodeData.i18n[e]:this.nodeData.title}}),watch:{nodeData:{handler:function(e,t){var a=JSON.stringify(e),n=JSON.stringify(t);if(a!==n){var i=e.id,s=e.menuCode,r=e.link,o=e.actions;this.$store.dispatch("tabs/updateTab",{id:i,menuCode:s,link:r,actions:o,title:this.getMenuTitle})}},deep:!0}},methods:{handleNavClick:function(){var e=this,t=this.nodeData,a=t.id,n=t.title,i=t.menuCode,s=t.openType,r=t.viewType,o=t.link,c=t.sizeWidth,l=t.sizeHeight,u=t.actions;switch(s){case 2:if(1===r)window.open("").location=o;else if(2===r){var d={width:800,height:600,top:0,left:0};c&&(d.width=c,d.left=window.innerWidth/2-c/2+window.screenLeft),l&&(d.height=l,d.top=window.innerHeight/2-l/2+window.screenTop);var p="\n              resizable=no,\n              scrollbars=no,\n              width='".concat(d.width,"',\n              height='").concat(d.height,"',\n              top='").concat(d.top,"',\n              left='").concat(d.left,"'\n            ");window.open(o,i,p)}break;case 3:var f="/".concat(o),h={id:a,menuCode:i,link:o,actions:u,title:this.getMenuTitle};5===r&&(f="/".concat(i),h.viewType=r),this.$route.path!==f&&(this.isMobile&&this.$store.dispatch("app/setSideBarCollapse"),this.$store.dispatch("tabs/setTabs",h),this.$store.dispatch("updateUserPreferences"),this.$router.push({path:f}).then((function(){e.$bus.$emit("check-tab-nav-width")})));break;case 4:var m={component:o,id:"only",headerTitle:n,contentSize:{width:"".concat(c,"px"),height:"".concat(l,"px")}},b={src:o,parent:"unique"};5===r&&(m.component="Iframe"),this.$store.dispatch("JsPanels/addPanel",{settings:m,props:b});break;default:break}}}}),oe=re,ce=(a("54a5"),Object(f["a"])(oe,ie,se,!1,null,"fe1d2dfc",null)),le=ce.exports,ue={name:"SideBar",components:{ScrollBar:r["a"],MenuNode:le},data:function(){return{activeIndex:"1",environment:"production"}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(u["b"])("app",{isMobile:function(e){return e.isMobile},isSideBarCollapse:function(e){return e.isSideBarCollapse}})),Object(u["b"])("tabs",{tabs:function(e){return e.tabs}})),Object(u["b"])("menu",{menuList:function(e){return e.menuList}})),{},{getProjectName:function(){return"Vue_Core_System"},getActiveTab:function(){var e=this;return this.tabs.find((function(t){var a="/".concat(t.link);return t.viewType&&(a="/".concat(t.menuCode)),e.$route.path===a}))}}),watch:{$route:{handler:function(){this.setMenuIndex()},deep:!0},tabs:{handler:function(){this.setMenuIndex()},deep:!0}},created:function(){this.setMenuIndex()},methods:{setMenuIndex:function(){var e=this.getActiveTab;this.activeIndex=e?String(e.id):"1"},toggleSideBar:function(){this.$store.dispatch("app/setSideBarCollapse")},emitCheckTabNav:function(e){"width"===e.propertyName&&this.$bus.$emit("check-tab-nav-width")},switchRoute:function(e){this.$route.path!==e&&(this.isMobile&&this.$store.dispatch("app/setSideBarCollapse"),this.$router.push({path:e}),this.$bus.$emit("check-tab-nav-width"))},getMenuTitle:function(e,t){var a=this.$i18n.locale;return e&&e[a]?e[a]:t}}},de=ue,pe=(a("4b42"),Object(f["a"])(de,ae,ne,!1,null,"1d3c3e79",null)),fe=pe.exports,he=fe,me=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"sideTab",collapse:e.isSideTabCollapse}},[a("ul",{staticClass:"tabList"},e._l(e.tabs,(function(t){return a("li",{key:t.name,class:{active:e.activeTab===t.name},on:{click:function(a){return e.switchTab(t.name)}}},[a("span",[e._v(e._s(t.label))]),"BulletinSummary"===t.name?a("el-badge",{attrs:{hidden:!e.totalUnread,value:e.totalUnread,max:99}}):e._e()],1)})),0),a("ScrollBar",{staticClass:"sideTabContent"},[a("transition",{attrs:{duration:200,name:"fade",mode:"out-in","enter-active-class":"animate__animated animate__fadeIn","leave-active-class":"animate__animated animate__fadeOut"}},[a(e.activeTab,{tag:"components",style:{animationDuration:".2s"}})],1)],1)],1)},be=[],ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{id:"bulletinSummary"}},[e.isError?a("div",{staticClass:"refresh"},[a("el-button",{attrs:{icon:"el-icon-refresh-left",type:"info"},on:{click:e.getBulletinSummaries}})],1):e._e(),e.bulletinSummaries.length?a("el-collapse",{model:{value:e.activeMainCollapse,callback:function(t){e.activeMainCollapse=t},expression:"activeMainCollapse"}},[e._l(e.bulletinSummaries,(function(t){return[a("MainClassWrapper",{key:t.mainClassName,attrs:{mainClass:t,activeMainCollapse:e.activeMainCollapse}})]}))],2):a("div",{staticClass:"noBulletins"},[e._v("沒有任何新公告")])],1)},ge=[],Ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-collapse-item",{staticClass:"mainClass",attrs:{name:e.mainClass.mainClassName}},[a("template",{slot:"title"},[a("el-badge",{attrs:{"is-dot":"",hidden:e.checkDotShow}},[a("span",[e._v(e._s(e.mainClass.mainClassName))]),a("span",[e._v(e._s("("+e.unreadCount+"/"+e.totalCount+")"))])])],1),a("div",{staticClass:"mainClassWrapper"},[e._l(e.mainClass.list,(function(e){return[a("SubClassWrapper",{key:e.subClassName,attrs:{subClass:e}})]}))],2)],2)},we=[],Se=(a("4de4"),a("13d5"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"subClassWrapper"},[a("div",{staticClass:"subTitle"},[e._v(e._s(e.subClass.subClassName))]),a("el-collapse",e._l(e.computedBulletin,(function(t,n){return a("el-collapse-item",{key:t.id,nativeOn:{click:function(a){return e.handleBulletinRead(t.id,t.isRead)}}},[a("template",{slot:"title"},[t.isRead?e._e():a("span",{staticClass:"dot"}),a("span",[e._v(e._s(t.title))])]),a("div",{ref:"content",refInFor:!0,staticClass:"content fr-view",domProps:{innerHTML:e._s(e.contentReformat(t.content))},on:{click:function(t){return e.handleContentClick(t,n)}}}),a("div",{staticClass:"lastModify"},[a("span",[e._v("最後修改：")]),a("el-tag",{attrs:{type:"info"}},[a("i",{staticClass:"el-icon-user-solid"}),a("span",[e._v(e._s(t.updatedByName))])])],1)],2)})),1)],1)}),ke=[],_e=(a("d81d"),a("2909")),ye=a("b3b0"),xe={name:"SubClassWrapper",props:{subClass:{type:Object,default:null}},computed:Object(s["a"])(Object(s["a"])({},Object(u["b"])("bulletinSummaries",{totalUnread:function(e){return e.totalUnread}})),{},{computedBulletin:function(){return this.subClass.list.filter((function(e){return!!e}))}}),watch:{totalUnread:{handler:function(){this.postUnreadMessage()}}},created:function(){this.postUnreadMessage()},methods:{postUnreadMessage:function(){if(this.$route.query.sideTab){var e={type:"unreadCount",payload:{unreadCount:this.totalUnread}};window.top.postMessage(e,"*")}},handleContentClick:function(e,t){var a=e.target;if("IMG"===a.tagName&&this.$route.query.sideTab){var n=Object(_e["a"])(this.$refs.content[t].querySelectorAll("img")).map((function(e){return e.src})),i=n.findIndex((function(e){return a.src===e})),s={type:"lightBox",payload:{imgSrcList:n,imgIndex:i}};window.top.postMessage(s,"*")}},contentReformat:B["c"],handleBulletinRead:function(e,t){var a=this;return Object(S["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t){n.next=9;break}return n.prev=1,n.next=4,ye["a"].updateBulletinsRead(e);case 4:a.$store.dispatch("bulletinSummaries/updateUnread",e),n.next=9;break;case 7:n.prev=7,n.t0=n["catch"](1);case 9:case"end":return n.stop()}}),n,null,[[1,7]])})))()}}},Te=xe,$e=(a("74c7"),Object(f["a"])(Te,Se,ke,!1,null,"7da73b1c",null)),Oe=$e.exports,Ne={name:"MainClassWrapper",components:{SubClassWrapper:Oe},props:{mainClass:{type:Object,default:null},activeMainCollapse:{type:Array,default:null}},data:function(){return{}},computed:{unreadCount:function(){return this.mainClass.list.reduce((function(e,t){return e+t.list.filter((function(e){return e&&!e.isRead})).length}),0)},totalCount:function(){return this.mainClass.list.reduce((function(e,t){return e+t.list.filter((function(e){return e})).length}),0)},checkDotShow:function(){var e=this;return!!this.activeMainCollapse.find((function(t){return t===e.mainClass.mainClassName}))||!this.unreadCount}},methods:{}},Me=Ne,je=(a("f8ba"),Object(f["a"])(Me,Ce,we,!1,null,"a80c64b8",null)),Be=je.exports,Pe={name:"BulletinSummary",components:{MainClassWrapper:Be},data:function(){return{loading:!1,activeMainCollapse:[],isError:!1}},computed:Object(s["a"])({},Object(u["b"])("bulletinSummaries",{bulletinSummaries:function(e){return e.bulletinSummaries}})),created:function(){},beforeDestroy:function(){},methods:{getBulletinSummaries:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isError=!1,e.loading=!0,t.next=5,e.$store.dispatch("bulletinSummaries/getBulletinSummaries");case 5:t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.isError=!0;case 10:return t.prev=10,e.loading=!1,t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[0,7,10,13]])})))()}}},Ee=Pe,Ie=(a("d4f6"),Object(f["a"])(Ee,ve,ge,!1,null,"61bcc467",null)),Re=Ie.exports,De={name:"SideTab",components:{ScrollBar:r["a"],BulletinSummary:Re},data:function(){return{activeTab:"BulletinSummary",tabs:[{label:"公告摘要",name:"BulletinSummary"}]}},computed:Object(s["a"])(Object(s["a"])({},Object(u["b"])("app",{isSideTabCollapse:function(e){return e.isSideTabCollapse}})),Object(u["b"])("bulletinSummaries",{totalUnread:function(e){return e.totalUnread}})),methods:{switchTab:function(e){this.activeTab=e}}},Ue=De,ze=(a("736a"),Object(f["a"])(Ue,me,be,!1,null,"4da515e4",null)),Ae=ze.exports,Le=Ae,We={name:"IndexLayout",components:{Header:te,SideBar:he,SideTab:Le,JsPanels:b,ScrollBar:r["a"],BulletinSummary:Re},data:function(){return{useSideTabs:!0}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(u["b"])("app",{fontSize:function(e){return e.fontSize},isMobile:function(e){return e.isMobile},isSideBarCollapse:function(e){return e.isSideBarCollapse},isSideTabCollapse:function(e){return e.isSideTabCollapse}})),Object(u["b"])("tabs",{tabs:function(e){return e.tabs}})),{},{getActiveTab:function(){var e=[];return this.tabs.forEach((function(t){t.viewType||e.push(t.link)})),e},notIframe:function(){return!this.$route.query.iframe}}),mounted:function(){window.innerWidth<996&&!this.isMobile&&this.$store.dispatch("app/setIsMobile"),window.addEventListener("resize",this.windowResizeHandler)},beforeDestroy:function(){window.removeEventListener("resize",this.windowResizeHandler)},methods:{windowResizeHandler:g()((function(e){this.$bus.$emit("resize-table-height"),this.checkWidth(e)}),200),checkWidth:function(e){this.$bus.$emit("check-tab-nav-width");var t=e.target.innerWidth>996&&this.isMobile,a=e.target.innerWidth<996&&!this.isMobile;(t||a)&&this.$store.dispatch("app/setIsMobile"),this.isMobile&&this.isSideBarCollapse&&this.toggleSideBar(),this.isMobile&&this.isSideTabCollapse&&this.toggleSideTab()},toggleSideBar:function(){this.$store.dispatch("app/setSideBarCollapse")},toggleSideTab:function(){this.$store.dispatch("app/setSideTabCollapse")}}},qe=We,Je=Object(f["a"])(qe,n,i,!1,null,null,null);t["default"]=Je.exports},"96c4":function(e,t,a){"use strict";var n=a("f6b2"),i=a.n(n);i.a},"9f89":function(e,t,a){},bb53:function(e,t,a){"use strict";var n=a("5f2c"),i=a.n(n);i.a},d4f6:function(e,t,a){"use strict";var n=a("5ca5"),i=a.n(n);i.a},daab:function(e,t,a){},f23a:function(e,t,a){},f6b2:function(e,t,a){},f6b9:function(e,t,a){"use strict";var n=a("6c9e"),i=a.n(n);i.a},f8ba:function(e,t,a){"use strict";var n=a("5115f"),i=a.n(n);i.a}}]);